# GoogleDrive - File Management Automation


## Description
Automate your GoogleDrive file operations and management.

- Upload and download files
- Delete files
- Search for files and custom properties

## Installation
### Pre-requisites

- Linx Designer
- Google Developer Account

### Register Google API service acccount credentials

1. **Register** a new project/app on the [Google Developer console](https://console.developers.google.com/).
1. Enable the following APIs for your project.
   1. Select the scopes:
      - *Google Drive API*
      - *Google Sheets API*
1. Create new 'Service Account' credentials with *owner* permissions.
1. Click **Manage service accounts**
1. In the **Actions** column, click **Create Key**.
1. **Export** the credentials as a JSON file.
1. **Copy** the whole JSON object from the exported file.

### Configure your Solution

1. Open the sample Solution in your Linx Designer.
1. Edit the *$.Settings* values:
   | Name | Type | Value  
   | --- | --- | --- 
   | `GoogleAPIAuthCredentials` |  string | *{copied json object}* | 
   | `ShareWithUserEmail` |  string | *{your email}* | 

   > `ShareWithUserEmail`: This will be used to share items between the service account that was registered and your personal google drive account so that you may see the files in your GoogleDrive dashboard.

1. **Save** the Solution.

## Usage

### Get the details of authenticated user

Retrieve the details of the authenticated service account.

1. Debug or drag the *GetAbout* function in your own function.
2. Run the function.
3. View the details of the authenticated service account as the result of the web service call.


### Generate and add custom properties

Retrieves all the GoogleDrive items for the service account.

For each item, a random string is generated and then the file is updated with this new custom property. The file details are then retrieved in more details from the API and logged to a local text file.

1. Debug or drag the *GenerateAndAddCustomProperties* function in your own function.
2. Run the function.
3. View the log of the files and their unique Ids.


### Search for files by custom property

The list of drive item ids that was generated by 'GenerateAndAddCustomProperties' is read.

For each line, the file details of the matching item on the API are retrieved.

This file doesnt achieve anything more, use it as a template for looping through GDrive files and searching.

### Delete files and log a record entry

The list of drive item ids that was generated by 'GenerateAndAddCustomProperties' is read.

For each line, the drive item matching the ID is deleted from the API.

A log is then written.

1. Debug or drag the *DeleteFilesAndLogRecord* function in your own function.
2. Run the function.
3. View the log of the deleted files.

### Download non-Google file types to your local drive

This function downloads the contents of non-native Google file types and writes them out to a local file drive.

1. Debug or drag the *DownloadGDriveFilesToLocalDrive* function in your own function.
2. Run the function.
3. Your files will be written out locally.

### Download GoogleDrive file types to your local drive

This function downloads the contents of native Google file types and writes them out to a local file drive.

1. Debug or drag the *ExportGDriveGoogleFilesToLocalDrive* function in your own function.
2. Run the function.
3. Your files will be written out locally.


### Upload files to GoogleDrive

This function uploads the contents of a local file directory to a Google drive instance in their native format.

1. Place files in the source directory.
1. Debug or drag the *UploadLocalFilesToGDrive* function in your own function.
2. Run the function.
3. Your files will be uploaded and moved to a backup folder.


### Upload files to GoogleDrive (Google file types)

This function uploads the contents of a local file directory to a Google drive instance in their matching native Google format.

1. Place files in the source directory.
1. Debug or drag the *UploadLocalFilesToGDriveInGoogleFormat* function in your own function.
2. Run the function.
3. Your files will be uploaded and moved to a backup folder.

## Contributing

For questions please ask the [Linx community](https://linx/software/community) or use the [Slack channel](https://linxsoftware.slack.com/archives/C01FLBC1XNX). 

## License

[MIT](https://github.com/linx-software/template-repo/blob/main/LICENSE.txt)

