# GoogleDrive file management App

## Overview

The provided sample application includes:

- Connecting to the Google Drive API
- Custom functions which sync your local files with your google drive.

---

### Additional resources

- [Google Drive - Linx integration guide](https://linx.software/docs/guides/googleapis/)

---

### Pre-requisites

- Linx Designer
- Google Drive developer account

---

### Dependencies

#### Linx Designer

This solution was developed in the Linx Designer `v5.20.2.0`

---

## Setting up the sample

Create a new project on Google Developer

1. Register a new project/app on the [Google Developer console](https://console.developers.google.com/).
1. Enable the following APIs for your project.
   1. Select the scopes:
      - `Google Drive API`
      - `Google Sheets API`
1. Create new 'Service Account' credentials with 'owner' permissions.
1. Click 'Manage service accounts'
1. In the 'Actions' column, click **Create Key**.
1. Export the credentials as a JSON file.
1. Copythe whole JSON object from the exported file.

Configure the Solution's $.Settings:

1. Open the [sample Solution](Solution.lsoz) in your Linx Designer.
1. Edit the $.Setting values:

   - `googleAPI_AuthCredentials`: Paste the copied JSON object.
     stage.
   - `share_with_user_email`: Add your personal email in here. This will be used to share items between the service account that was just registered and your personal google drive account so that you may see the files in your GoogleDrive dashboard.

1. Save the Solution.

---

## Using the sample

---

## Custom functions

### GetAboutDetail

Gets the details of the currently authenticated service account.

### GenerateAndAddCustomProperties

Retrieves all the GoogleDrive items for the service account.

For each item, a random string is generated and then the file is updated with this new custom property. The file details are then retrieved in more details from the API and logged to a local text file.

### SearchFilesByCustomProperty

The list of drive item ids that was generated by 'GenerateAndAddCustomProperties' is read.

For each line, the file details of the matching item on the API are retrieved.

### DeleteFilesAndLogRecord

The list of drive item ids that was generated by 'GenerateAndAddCustomProperties' is read.

For each line, the drive item matching the ID is deleted from the API.

A log is then written.

### Download_GDriveFiles_ToLocalDrive

This function downloads the contents of non-native Google file types and writes them out to a local file drive.

### Export_GDrive_GoogleFiles_ToLocalDrive

This function downloads the contents of native Google file types and writes them out to a local file drive.

### Upload_LocalFilesToGDrive

This function uploads the contents of a local file directory to a Google drive instance in their native format.

### Upload_LocalFilesToGDrive_InGoogleFormat

This function uploads the contents of a local file directory to a Google drive instance in their matching native Google format.
